<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Vigor Modem to Prometheus" /><meta property="og:locale" content="en" /><meta name="description" content="Vigor Modem to Prometheus" /><meta property="og:description" content="Vigor Modem to Prometheus" /><link rel="canonical" href="https://docs.nels.one/posts/vigor-to-prometheus/" /><meta property="og:url" content="https://docs.nels.one/posts/vigor-to-prometheus/" /><meta property="og:site_name" content="Nels.One" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-07T10:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Vigor Modem to Prometheus" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-21T18:57:55+01:00","datePublished":"2022-04-07T10:00:00+01:00","description":"Vigor Modem to Prometheus","headline":"Vigor Modem to Prometheus","mainEntityOfPage":{"@type":"WebPage","@id":"https://docs.nels.one/posts/vigor-to-prometheus/"},"url":"https://docs.nels.one/posts/vigor-to-prometheus/"}</script><title>Vigor Modem to Prometheus | Nels.One</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nels.One"><meta name="application-name" content="Nels.One"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="/assets/lib/fonts/main.css"><link rel="stylesheet" href="/assets/lib/bootstrap-4.6.1/bootstrap.min.css"><link rel="stylesheet" href="/assets/lib/fontawesome-6/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/lib/magnific-popup-1.1.0/magnific-popup.css"> <script src="/assets/lib/jquery-3.6.0/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/45429927?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nels.One</a></div><div class="site-subtitle font-italic">Collection of Documentation, Scripts and Temaplates for Projects</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/repo-docker-compose/" class="nav-link"> <i class="fa-fw fab fa-docker ml-xl-3 mr-xl-3 unloaded"></i> <span>DOCKER REPO</span> </a><li class="nav-item"> <a href="/repo-powershell/" class="nav-link"> <i class="fa-fw fa-solid fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>POWERSHELL REPO</span> </a><li class="nav-item"> <a href="/repo-python/" class="nav-link"> <i class="fa-fw fa-brands fa-python ml-xl-3 mr-xl-3 unloaded"></i> <span>PYTHON REPO</span> </a><li class="nav-item"> <a href="/repo-one-liners/" class="nav-link"> <i class="fa-fw fa-solid fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>ONE-LINER REPO</span> </a><li class="nav-item"> <a href="/a1-testing/" class="nav-link"> <i class="fa-fw fa-solid fa-vial ml-xl-3 mr-xl-3 unloaded"></i> <span>TESTING</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/nelshi" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Vigor Modem to Prometheus</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Vigor Modem to Prometheus</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/nelshi">Nelson</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1649322000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-04-07 </em> </span> <span> Updated <em class="timeago" data-ts="1663783075" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-09-21 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1436 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><h1 id="vigor-modem-to-prometheus">Vigor Modem to Prometheus</h1><p>A python script to read the detailed DrayTek router stats.</p><p>The following stats are recorded and presented as Open Metrics (Prometheus) stats.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>&gt; vdsl status more
  ---------------------- ATU-R Info (hw: annex A, f/w: annex A/B/C) -----------
                  Near End        Far End    Note
 Trellis      :      1               1
 Bitswap      :      1               1
 ReTxEnable   :      1               1
 VirtualNoise :      0               0
 20BitSupport :      0               0
 LatencyPath  :      0               0
 LOS          :      0               0
 LOF          :      0               0
 LPR          :      0               0
 LOM          :      0               0
 SosSuccess   :      0               0
 NCD          :      0               0
 LCD          :      0               0
 FECS         :      0            2575 (seconds)
 ES           :     35               3 (seconds)
 SES          :      3               1 (seconds)
 LOSS         :      0               0 (seconds)
 UAS          :     27            1861 (seconds)
 HECError     :      0               0
 CRC          :    126              31
 RsCorrection :      0               0
 INP          :    230             160 (symbols)
 InterleaveDelay :      0              62 (1/100 ms)
 NFEC         :     32              32
 RFEC         :     16              16
 LSYMB        :     16              16
 INTLVBLOCK   :     32              32
 AELEM        :      0            ----
</pre></table></code></div></div><h2 id="environment-variables"><span class="mr-2">Environment Variables</span><a href="#environment-variables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The script requires some environment variables to be loaded, i do this in docker using a .env config file:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>IP=192.168.100.1
USERNAME=admin
PASSWORD=admin
SERVER_PORT=8081
METRICS_PORT=8001
TELNET_CMD=/usr/bin/telnet
SPAWN_TIMEOUT=5
</pre></table></code></div></div><h2 id="telnet"><span class="mr-2">Telnet</span><a href="#telnet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The script spawns a telnet connection to the router to gather the stats from the CLI (It could be easily changed to use SSH)</p><p>The remote prometheus call to <code class="language-plaintext highlighter-rouge">/metrics</code>, fires off the telnet request, so this will poll as fast as you want it to.</p><h2 id="python-modules"><span class="mr-2">Python Modules</span><a href="#python-modules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://pexpect.readthedocs.io/en/stable/">Python Expect</a> (to gather the stats) <a href="https://ttp.readthedocs.io/en/latest/">Template Text Parser</a> (to parse the stats) <a href="https://github.com/prometheus/client_python">Prometheus Python Client</a> (to make them available to Prometheus)</p><h2 id="prometheus"><span class="mr-2">Prometheus</span><a href="#prometheus" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Set as a target as normal.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>- job_name: router_stats
  honor_timestamps: true
  scrape_interval: 5m
  scrape_timeout: 10s
  metrics_path: /metrics
  scheme: http
  static_configs:
  - targets:
    - 192.168.0.1:8003
</pre></table></code></div></div><h2 id="dockerfile-and-script"><span class="mr-2">Dockerfile and Script</span><a href="#dockerfile-and-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">dockerfile</code></p><div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> python:3-slim</span>

<span class="k">RUN </span><span class="nb">set</span> <span class="nt">-eux</span><span class="p">;</span> <span class="se">\
</span>    useradd <span class="nt">-ms</span> /bin/bash puser<span class="p">;</span> <span class="se">\
</span>    pip <span class="nb">install </span>prometheus_client pexpect ttp<span class="p">;</span> <span class="se">\
</span>    apt update<span class="p">;</span> <span class="se">\
</span>    apt-get <span class="nb">install</span> <span class="nt">-y</span> <span class="nt">--no-install-recommends</span> <span class="se">\
</span>        curl <span class="se">\
</span>        telnet <span class="se">\
</span>        <span class="o">&amp;&amp;</span> <span class="nb">rm</span> <span class="nt">-rf</span> /var/lib/apt/lists/<span class="k">*</span> <span class="p">;</span> <span class="se">\
</span>    <span class="nb">echo</span> <span class="s2">"Done"</span>

<span class="c"># run as non-root user - safety first!</span>
<span class="k">USER</span><span class="s"> puser</span>
<span class="k">WORKDIR</span><span class="s"> /home/puser</span>

<span class="c"># copy code into image</span>
<span class="k">COPY</span><span class="s"> . /home/puser/</span>

<span class="c"># fix for https://github.com/dmulyalin/ttp/issues/54</span>
<span class="k">ENV</span><span class="s"> TTPCACHEFOLDER=/tmp</span>
<span class="k">ENV</span><span class="s"> IP="192.168.200.1"</span>
<span class="k">ENV</span><span class="s"> USERNAME="admin"</span>
<span class="k">ENV</span><span class="s"> PASSWORD="admin"</span>

<span class="k">ENV</span><span class="s"> SERVER_PORT=8081</span>
<span class="k">ENV</span><span class="s"> METRICS_PORT=8001</span>

<span class="c"># where does telnet live?</span>
<span class="k">ENV</span><span class="s"> TELNET_CMD='/usr/bin/telnet' </span>
<span class="c"># timeout to telnet to router and grab stats</span>
<span class="k">ENV</span><span class="s"> SPAWN_TIMEOUT=5</span>

<span class="k">EXPOSE</span><span class="s"> 8081</span>
<span class="k">EXPOSE</span><span class="s"> 8001</span>

<span class="c"># and run the code :)</span>
<span class="k">ENTRYPOINT</span><span class="s"> ["python3"]</span>
<span class="k">CMD</span><span class="s"> ["vigor-to-prom.py"]</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">vigor-to-prom.py</code></p><div class="language-py highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="c1">#
# A python OpenMetrics / Prometheus server to grab data from a DrayTek router
#
# Uses 'expect' to gather data from the telnet port
</span>
<span class="c1"># https://www.draytek.co.uk/support/guides/kb-dsl-status-more
</span>
<span class="c1"># https://kitz.co.uk/adsl/linestats_errors.htm
</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getenv</span>

<span class="kn">import</span> <span class="nn">http.server</span>

<span class="kn">from</span> <span class="nn">prometheus_client</span> <span class="kn">import</span> <span class="n">start_http_server</span>
<span class="kn">from</span> <span class="nn">prometheus_client</span> <span class="kn">import</span> <span class="n">Summary</span><span class="p">,</span> <span class="n">Gauge</span>
<span class="kn">from</span> <span class="nn">prometheus_client.core</span> <span class="kn">import</span> <span class="n">CounterMetricFamily</span><span class="p">,</span> <span class="n">REGISTRY</span>

<span class="kn">import</span> <span class="nn">pexpect</span> <span class="c1"># expect
</span><span class="kn">from</span> <span class="nn">ttp</span> <span class="kn">import</span> <span class="n">ttp</span> <span class="c1"># templating
</span>
<span class="c1"># https://prometheus.io/docs/concepts/metric_types/
</span>
<span class="n">CUSTOM_COUNTERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'ne_LOS'</span><span class="p">:</span> <span class="s">'Loss Of Signal count'</span><span class="p">,</span>
    <span class="s">'ne_LOF'</span><span class="p">:</span> <span class="s">'Loss Of Frame count'</span><span class="p">,</span>
    <span class="s">'ne_LPR'</span><span class="p">:</span> <span class="s">'Loss Of Power count'</span><span class="p">,</span>
    <span class="s">'ne_LOM'</span><span class="p">:</span> <span class="s">'Loss Of Margin count'</span><span class="p">,</span>
    <span class="s">'ne_NCD'</span><span class="p">:</span> <span class="s">'No Cell Delineation failure count'</span><span class="p">,</span>
    <span class="s">'ne_LCD'</span><span class="p">:</span> <span class="s">'Loss Of Cell Delineation failure count'</span><span class="p">,</span>
    <span class="s">'ne_CRC'</span><span class="p">:</span> <span class="s">'Cyclic Redundancy Check error count, number of CRC 8 anomalies (number of incorrect CRC)'</span><span class="p">,</span>
    <span class="s">'ne_HECError'</span><span class="p">:</span> <span class="s">'Header Error Check Error count, HEC anomalies in the ATM Data Path'</span><span class="p">,</span>

    <span class="s">'fe_LOS'</span><span class="p">:</span> <span class="s">'Loss Of Signal count'</span><span class="p">,</span>
    <span class="s">'fe_LOF'</span><span class="p">:</span> <span class="s">'Loss Of Frame count'</span><span class="p">,</span>
    <span class="s">'fe_LPR'</span><span class="p">:</span> <span class="s">'Loss Of Power count'</span><span class="p">,</span>
    <span class="s">'fe_LOM'</span><span class="p">:</span> <span class="s">'Loss Of Margin count'</span><span class="p">,</span>
    <span class="s">'fe_NCD'</span><span class="p">:</span> <span class="s">'No Cell Delineation failure count'</span><span class="p">,</span>
    <span class="s">'fe_LCD'</span><span class="p">:</span> <span class="s">'Loss Of Cell Delineation failure count'</span><span class="p">,</span>
    <span class="s">'fe_CRC'</span><span class="p">:</span> <span class="s">'Cyclic Redundancy Check error count, number of CRC 8 anomalies (number of incorrect CRC)'</span><span class="p">,</span>
    <span class="s">'fe_HECError'</span><span class="p">:</span> <span class="s">'Header Error Check Error count, HEC anomalies in the ATM Data Path'</span><span class="p">,</span>
    
<span class="p">}</span>

<span class="n">LATENCY</span> <span class="o">=</span> <span class="n">Summary</span><span class="p">(</span><span class="s">'server_latency_gather_router_data_seconds'</span><span class="p">,</span> <span class="s">'Time to get stats from the router'</span><span class="p">)</span>

<span class="n">NE_FECS</span>  <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'router_ne_fecs'</span><span class="p">,</span><span class="s">'Forward Error Correction Seconds - Line far-end (FECS-LFE)'</span><span class="p">)</span>
<span class="n">NE_ES</span>    <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'router_ne_es'</span><span class="p">,</span><span class="s">'Errored Seconds - Line far-end (ES-LFE)'</span><span class="p">)</span>
<span class="n">NE_SES</span>	 <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'router_ne_ses'</span><span class="p">,</span><span class="s">'Severely Errored Seconds - Line far-end (SES-LFE)'</span><span class="p">)</span>
<span class="n">NE_LOSS</span>  <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'router_ne_loss'</span><span class="p">,</span><span class="s">'Loss Of Signal Seconds'</span><span class="p">)</span>
<span class="n">NE_UAS</span>	 <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'router_ne_uas'</span><span class="p">,</span><span class="s">'Un-Available Seconds - Line (UAS-L) &amp; Unavailable Seconds - Line far-end (UAS-LFE)'</span><span class="p">)</span>

<span class="n">FE_FECS</span>  <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'router_fe_fecs'</span><span class="p">,</span><span class="s">'Forward Error Correction Seconds - Line far-end (FECS-LFE)'</span><span class="p">)</span>
<span class="n">FE_ES</span>    <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'router_fe_es'</span><span class="p">,</span><span class="s">'Errored Seconds - Line far-end (ES-LFE)'</span><span class="p">)</span>
<span class="n">FE_SES</span>	 <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'router_fe_ses'</span><span class="p">,</span><span class="s">'Severely Errored Seconds - Line far-end (SES-LFE)'</span><span class="p">)</span>
<span class="n">FE_LOSS</span>  <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'router_fe_loss'</span><span class="p">,</span><span class="s">'Loss Of Signal Seconds'</span><span class="p">)</span>
<span class="n">FE_UAS</span>	 <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'router_fe_uas'</span><span class="p">,</span><span class="s">'Un-Available Seconds - Line (UAS-L) &amp; Unavailable Seconds - Line far-end (UAS-LFE)'</span><span class="p">)</span>

<span class="n">DSL_UPDOWN</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'router_up_down'</span><span class="p">,</span><span class="s">'1=up "SHOWTIME", 0=down anything else'</span><span class="p">,</span> <span class="p">[</span><span class="s">'status'</span><span class="p">])</span>

<span class="c1">#TODO: add some info gauges for the static text 
</span>
<span class="n">ext_template</span> <span class="o">=</span> <span class="s">"""
&lt;group name="rs"&gt;
  ---------------------- ATU-R Info (hw: annex , f/w: annex ) -----------
 Near End                   Far End  Note
 Trellis          :  
 Bitswap          :  
 ReTxEnable       :  
 VirtualNoise     :  
 20BitSupport     :  
 LatencyPath      :  
 LOS              :  
 LOF              :  
 LPR              :  
 LOM              :  
 SosSuccess       :  
 NCD              :  
 LCD              :  
 FECS             :   (seconds)
 ES               :   (seconds)
 SES              :   (seconds)
 LOSS             :   (seconds)
 UAS              :   (seconds)
 HECError         :  
 CRC              :  
 INP              :   (symbols)
 INTLVDelay       :   (1/100 ms)
 NFEC             :  
 RFEC             :  
 LSYMB            :  
 INTLVBLOCK       :  
 AELEM            :  ----
&lt;/group&gt;
"""</span>

<span class="n">wan_template</span> <span class="o">=</span> <span class="s">"""
&lt;group name="wan"&gt;

Link Status: 
Firmware Version: 
VDSL2 Profile: 
Basic	Status	Upstream	Downstream 
Actual Data Rate: 
SNR: 
G.Vectoring Status:	
&lt;/group&gt;
"""</span>

<span class="k">class</span> <span class="nc">RouterCollector</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="c1">#
# Prometheus stuff, called when ever the METRICS_PORT is opened
#
</span>    <span class="o">@</span><span class="n">LATENCY</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="c1"># measure who long this function takes to run
</span>    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">print</span><span class="p">(</span><span class="s">"Gathering router stats..."</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">child</span> <span class="o">=</span> <span class="n">pexpect</span><span class="p">.</span><span class="n">spawn</span> <span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">TELNET_CMD</span> <span class="o">+</span> <span class="s">' '</span> <span class="o">+</span> <span class="n">config</span><span class="p">.</span><span class="n">IP</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">config</span><span class="p">.</span><span class="n">SPAWN_TIMEOUT</span><span class="p">)</span>

            <span class="n">child</span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">"Account:"</span><span class="p">)</span>

            <span class="n">child</span><span class="p">.</span><span class="n">send</span> <span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">USERNAME</span> <span class="o">+</span><span class="s">"</span><span class="se">\r</span><span class="s">"</span><span class="p">)</span>
            <span class="n">child</span><span class="p">.</span><span class="n">expect</span> <span class="p">(</span><span class="s">"Password: "</span><span class="p">)</span>
            <span class="n">child</span><span class="p">.</span><span class="n">send</span> <span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">PASSWORD</span><span class="o">+</span><span class="s">"</span><span class="se">\r</span><span class="s">"</span><span class="p">)</span>
            <span class="n">child</span><span class="p">.</span><span class="n">expect</span> <span class="p">(</span><span class="s">"DrayTek&gt; "</span><span class="p">)</span>

            <span class="n">child</span><span class="p">.</span><span class="n">send</span> <span class="p">(</span><span class="s">"wan vdsl show basic</span><span class="se">\r</span><span class="s">"</span><span class="p">)</span>
            <span class="n">child</span><span class="p">.</span><span class="n">expect</span> <span class="p">(</span><span class="s">"DrayTek&gt; "</span><span class="p">)</span>
            <span class="n">wan_results</span> <span class="o">=</span> <span class="n">child</span><span class="p">.</span><span class="n">before</span>
            <span class="n">wan_results</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">wan_results</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">b</span><span class="s">'</span><span class="se">\r</span><span class="s">'</span><span class="p">,</span><span class="sa">b</span><span class="s">''</span><span class="p">),</span><span class="s">'ascii'</span><span class="p">)</span> <span class="c1"># convert to ascii string for parsing
</span>
            <span class="n">parser</span> <span class="o">=</span> <span class="n">ttp</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">wan_results</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">wan_template</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s">'INFO'</span><span class="p">)</span>
            <span class="n">parser</span><span class="p">.</span><span class="n">parse</span><span class="p">()</span> <span class="c1"># extract the info
</span>            <span class="n">wm</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">result</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s">'raw'</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">link_status</span> <span class="o">=</span> <span class="n">wm</span><span class="p">[</span><span class="s">'wan'</span><span class="p">][</span><span class="s">'link_status'</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">link_status</span> <span class="o">==</span> <span class="s">"SHOWTIME"</span><span class="p">:</span>
                <span class="n">DSL_UPDOWN</span><span class="p">.</span><span class="n">labels</span><span class="p">(</span><span class="n">link_status</span><span class="p">).</span><span class="nb">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DSL_UPDOWN</span><span class="p">.</span><span class="n">labels</span><span class="p">(</span><span class="n">link_status</span><span class="p">).</span><span class="nb">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            
            
        

            <span class="n">child</span><span class="p">.</span><span class="n">send</span> <span class="p">(</span><span class="s">"vdsl status more</span><span class="se">\r</span><span class="s">"</span><span class="p">)</span>
            <span class="n">child</span><span class="p">.</span><span class="n">expect</span> <span class="p">(</span><span class="s">"DrayTek&gt; "</span><span class="p">)</span>
            <span class="n">ext_results</span> <span class="o">=</span> <span class="n">child</span><span class="p">.</span><span class="n">before</span>
            <span class="n">child</span><span class="p">.</span><span class="n">send</span> <span class="p">(</span><span class="s">"exit</span><span class="se">\r</span><span class="s">"</span><span class="p">)</span>

            <span class="n">ext_results</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">ext_results</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">b</span><span class="s">'</span><span class="se">\r</span><span class="s">'</span><span class="p">,</span><span class="sa">b</span><span class="s">''</span><span class="p">),</span><span class="s">'ascii'</span><span class="p">)</span> <span class="c1"># convert to ascii string for parsing
</span>            <span class="c1">#print(ext_results)
</span>
            <span class="n">parser</span> <span class="o">=</span> <span class="n">ttp</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ext_results</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">ext_template</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s">'INFO'</span><span class="p">)</span>
            <span class="n">parser</span><span class="p">.</span><span class="n">parse</span><span class="p">()</span> <span class="c1"># extract the info
</span>
            <span class="c1"># print result in JSON format
</span>            <span class="c1">#p_ext_results = parser.result(format='json')[0]
</span>            <span class="c1">#print(p_ext_results)
</span>
            <span class="n">om</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">result</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s">'raw'</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#print(om)
</span>
            <span class="c1"># Load up the Prometheus custom counters
</span>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">CUSTOM_COUNTERS</span><span class="p">:</span>
                <span class="c1">#print("{} | {} | {}".format(c, CUSTOM_COUNTERS[c], om['rs'][c]))
</span>                <span class="k">yield</span> <span class="n">CounterMetricFamily</span><span class="p">(</span><span class="s">"router_"</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="n">CUSTOM_COUNTERS</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">om</span><span class="p">[</span><span class="s">'rs'</span><span class="p">][</span><span class="n">c</span><span class="p">])</span>
            
            <span class="c1"># load up the standard gauges - everything that is returned in seconds
</span>            <span class="n">NE_FECS</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="s">'rs'</span><span class="p">][</span><span class="s">'ne_FECS'</span><span class="p">])</span>
            <span class="n">NE_ES</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="s">'rs'</span><span class="p">][</span><span class="s">'ne_ES'</span><span class="p">])</span>
            <span class="n">NE_SES</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="s">'rs'</span><span class="p">][</span><span class="s">'ne_SES'</span><span class="p">])</span>
            <span class="n">NE_LOSS</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="s">'rs'</span><span class="p">][</span><span class="s">'ne_LOSS'</span><span class="p">])</span>
            <span class="n">NE_UAS</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="s">'rs'</span><span class="p">][</span><span class="s">'ne_UAS'</span><span class="p">])</span>

            <span class="n">FE_FECS</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="s">'rs'</span><span class="p">][</span><span class="s">'fe_FECS'</span><span class="p">])</span>
            <span class="n">FE_ES</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="s">'rs'</span><span class="p">][</span><span class="s">'fe_ES'</span><span class="p">])</span>
            <span class="n">FE_SES</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="s">'rs'</span><span class="p">][</span><span class="s">'fe_SES'</span><span class="p">])</span>
            <span class="n">FE_LOSS</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="s">'rs'</span><span class="p">][</span><span class="s">'fe_LOSS'</span><span class="p">])</span>
            <span class="n">FE_UAS</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="s">'rs'</span><span class="p">][</span><span class="s">'fe_UAS'</span><span class="p">])</span>

        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Error gathering stats:"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span>


<span class="k">class</span> <span class="nc">ServerHandler</span><span class="p">(</span><span class="n">http</span><span class="p">.</span><span class="n">server</span><span class="p">.</span><span class="n">BaseHTTPRequestHandler</span><span class="p">):</span>
<span class="c1">#
# Web Browser stuff
#
</span>    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">end_headers</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"Prometheus metrics available on port {} /metrics</span><span class="se">\n</span><span class="s">"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">METRICS_PORT</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">))</span> <span class="c1"># a byte string
</span>
<span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># read in environment variables
</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">IP</span><span class="o">=</span><span class="n">getenv</span><span class="p">(</span><span class="s">'IP'</span><span class="p">,</span><span class="s">'192.168.0.1'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">USERNAME</span><span class="o">=</span><span class="n">getenv</span><span class="p">(</span><span class="s">'USERNAME'</span><span class="p">,</span><span class="s">'admin'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">PASSWORD</span><span class="o">=</span><span class="n">getenv</span><span class="p">(</span><span class="s">'PASSWORD'</span><span class="p">,</span><span class="s">'password'</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">SERVER_PORT</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">getenv</span><span class="p">(</span><span class="s">'SERVER_PORT'</span><span class="p">,</span> <span class="s">'8081'</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">METRICS_PORT</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">getenv</span><span class="p">(</span><span class="s">'METRICS_PORT'</span><span class="p">,</span><span class="s">'8001'</span><span class="p">))</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">TELNET_CMD</span><span class="o">=</span><span class="n">getenv</span><span class="p">(</span><span class="s">'TELNET_CMD'</span><span class="p">,</span><span class="s">'/usr/bin/telnet'</span><span class="p">)</span> <span class="c1"># where does telnet live?
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">SPAWN_TIMEOUT</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">getenv</span><span class="p">(</span><span class="s">'SPAWN_TIMEOUT'</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>

    <span class="c1"># read in config from Environment Variables
</span>    <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
    <span class="c1">#print(config.IP,config.USERNAME,config.PASSWORD,config.SPAWN_TIMEOUT)
</span>
    <span class="c1"># this is called everytime the /metrics URI is called
</span>    <span class="n">REGISTRY</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="n">RouterCollector</span><span class="p">())</span>

    <span class="c1"># start metrics server
</span>    <span class="n">start_http_server</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">METRICS_PORT</span><span class="p">)</span>
    
    <span class="c1"># start web server - keeps the app up and running
</span>    <span class="n">server</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">server</span><span class="p">.</span><span class="n">HTTPServer</span><span class="p">((</span><span class="s">''</span><span class="p">,</span> <span class="n">config</span><span class="p">.</span><span class="n">SERVER_PORT</span><span class="p">),</span> <span class="n">ServerHandler</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Prometheus metrics available on port "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">METRICS_PORT</span><span class="p">)</span><span class="o">+</span><span class="s">" /metrics"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"HTTP server available on port "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">SERVER_PORT</span><span class="p">))</span>
    <span class="n">server</span><span class="p">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://github.com/mohclips/draytek_router_stats_prometheus
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/docker/'>docker</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/vigor/" class="post-tag no-text-decoration" >vigor</a> <a href="/tags/modem/" class="post-tag no-text-decoration" >modem</a> <a href="/tags/draytek/" class="post-tag no-text-decoration" >draytek</a> <a href="/tags/prometheus/" class="post-tag no-text-decoration" >prometheus</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Vigor+Modem+to+Prometheus+-+Nels.One&url=https%3A%2F%2Fdocs.nels.one%2Fposts%2Fvigor-to-prometheus%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Vigor+Modem+to+Prometheus+-+Nels.One&u=https%3A%2F%2Fdocs.nels.one%2Fposts%2Fvigor-to-prometheus%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdocs.nels.one%2Fposts%2Fvigor-to-prometheus%2F&text=Vigor+Modem+to+Prometheus+-+Nels.One" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/destiny-2-solo-script/">Destiny 2 Solo Script</a><li><a href="/posts/vigor-to-prometheus/">Vigor Modem to Prometheus</a><li><a href="/posts/uisp-docker/">UISP Docker Container</a><li><a href="/posts/unraid-rootshare/">unRAID Root Share</a><li><a href="/posts/powershell-hostfile-replacement/">Powershell Hostfile Replacement</a></ul></div><div id="access-tags"><div class="panel-heading"></div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/edgerouter/">edgerouter</a> <a class="post-tag" href="/tags/script/">script</a> <a class="post-tag" href="/tags/rmm/">rmm</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/cmd/">cmd</a> <a class="post-tag" href="/tags/dns/">dns</a> <a class="post-tag" href="/tags/modem/">modem</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/unraid/">unraid</a></div></div></div><script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/vigor-to-telegraf/"><div class="card-body"> <em class="small" data-ts="1649235600" data-df="ll" > Apr 6, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vigor to Telegraf</h3><div class="text-muted small"><p> Vigor to Telegraf Installation Copy script vigor-to-telegraf.py to a directory accessible by Telegraf Make the script executable chmod +x vigor-to-telegraf.py Edit the script variables u...</p></div></div></a></div><div class="card"> <a href="/posts/unraid-docker-memory-limits/"><div class="card-body"> <em class="small" data-ts="1651568400" data-df="ll" > May 3, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>unRAID Docker Memory Limits</h3><div class="text-muted small"><p> unRAID Docker Memory Limits Set Memory/RAM limits on a per container basis within unRAID Docker. Docker Edit Container Advanced View Ex...</p></div></div></a></div><div class="card"> <a href="/posts/psuedoethernet-access-wan-gui/"><div class="card-body"> <em class="small" data-ts="1563613200" data-df="ll" > Jul 20, 2019 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Psuedo-Ethernet WAN GUI Access</h3><div class="text-muted small"><p> Psuedo-Ethernet WAN GUI Access Allows access to modem GUI over LAN Port configure set interfaces pseudo-ethernet peth0 link eth0 set interfaces pseudo-ethernet peth0 address 192.168.100.1/24 set ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/vigor-to-telegraf/" class="btn btn-outline-primary" prompt="Older"><p>Vigor to Telegraf</p></a> <a href="/posts/uisp-docker/" class="btn btn-outline-primary" prompt="Newer"><p>UISP Docker Container</p></a></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> Â© 2022 <a href="https://github.com/nelshi">Nelson</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading"></div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/edgerouter/">edgerouter</a> <a class="post-tag" href="/tags/script/">script</a> <a class="post-tag" href="/tags/rmm/">rmm</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/cmd/">cmd</a> <a class="post-tag" href="/tags/dns/">dns</a> <a class="post-tag" href="/tags/modem/">modem</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/unraid/">unraid</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="/assets/lib/simple-jekyll-search-1.10.0/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="/assets/lib/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script> <script src="/assets/lib/lozad-1.16.0/lozad.min.js"></script> <script src="/assets/lib/clipboard-2.0.9/clipboard.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/dayjs.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/locale/en.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/plugin/relativeTime.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="/assets/lib/bootstrap-4.6.1/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
