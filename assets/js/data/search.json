[ { "title": "Install Duplicati as Windows Service", "url": "/posts/duplicati-as-service/", "categories": "windows", "tags": "windows, duplicati, service, backup", "date": "2022-09-15 10:00:00 +0100", "snippet": "Install Duplicati as Windows ServiceInstallationDownload Duplicati from HEREDuring install don’t mark Auto Start up optionOpen CMD as adminNavigate to the installation folder in CMD (this should be the same as long as you left it as default)cd \"C:\\Program Files\\Duplicati 2\\\"Now we will install the service .\\Duplicati.WindowsService.exe installStart the Duplicati service via Task Manager or Services.Go to http://localhost:8200/ngax/index.htmlYou might have to reconfigure things since Duplicati is no longer running as your user and is running as a system user." }, { "title": "Enable RDP from CMD", "url": "/posts/enable-rdp-cmd/", "categories": "windows", "tags": "windows, rdp", "date": "2022-07-17 10:00:00 +0100", "snippet": "Enable RDP from CMDEnable RDPreg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /fAllow Firewall Accessnetsh advfirewall firewall set rule group=\"remote desktop\" new enable=YesDisable RDPreg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 1 /fDisallow Firewall Accessnetsh advfirewall firewall set rule group=\"remote desktop\" new enable=No" }, { "title": "RDP Server Shadow Remote Control Users", "url": "/posts/rdp-shadow-remote-control/", "categories": "windows", "tags": "windows, rdp, remote, control, shadow", "date": "2022-07-03 10:00:00 +0100", "snippet": "RDP Server Shadow Remote Control UsersAccessingServer Manager - Remote Desktop Services - CollectionsRight-Click on session to “Shadow”PolicyDefault policy asks for user confirmation of Shadowing, which can be disabled via Group PolicyComputer &gt; Policies &gt; Administrative Templates &gt; Windows Components &gt; Remote Desktop Services &gt; Remote Desktop Session Host &gt; Connections &gt; Set rules for remote control of Remote Desktop Services user sessionsFull Control without user’s permission" }, { "title": "Remote CMD Shell Windows with PsExec", "url": "/posts/windows-remote-cmd-psexec/", "categories": "windows", "tags": "windows, cmd, remote", "date": "2022-06-24 10:00:00 +0100", "snippet": "Remote CMD Shell Windows with PsExecInstallationDownload PsExec from HEREExtract .zip locally to preferred folderOpen CMD in that location (via CMD cd or shift right-click “Open in Terminal”)Run the following to open up an interactive CMD on the remote machine (Alternatively replacing cmd.exe with powershell.exe).\\PsExec.exe -i -h \\\\IPAddressOrName -u Username -p Password \"cmd.exe\"" }, { "title": "Docker Container routing via VPN Connection", "url": "/posts/docker-container-over-vpn/", "categories": "docker", "tags": "docker, vpn, openvpn, container, network", "date": "2022-05-15 10:00:00 +0100", "snippet": "Docker Container routing via VPN ConnectionVPN ContainerCreate and configure docker container to run the VPN Client itself that other containers will route through.ich777/openvpn-clientDownload and import vpn.ovpn file into container from VPN Providervpn.ovpn# OpenVPN configuration file generated for ***** on Sun, 15 May 2022 09:00:00 +0000# Contains your private access keys, do not share publicly!# Edit at own risk!Ensure the connection is established by attaching to the container and running:curl ifconfig.ioThis will return the WAN IP address of the container - check to ensure it is correctly showing the VPN address.Routing ContainersOn any containers that need routing via the VPN Container, set the Network Type: None and add the Extra Parameter:--net=container:OpenVPN-Client" }, { "title": "unRAID Root Share", "url": "/posts/unraid-rootshare/", "categories": "unraid", "tags": "unraid, rootshare, share, smb", "date": "2022-05-05 10:00:00 +0100", "snippet": "unRAID Root ShareEnable a rootshare on unRAID to allow local moving of files between shares via another SMB client.Append the below to the existing configuration, replacing users as required. Settings Network Services/SMB SMB Extras Samba Extra Configuration#rootshare[rootshare]path = /mnt/usercomment =browseable = yesvalid users = nels #read_accesswrite list = nels #write_accessvfs objects =" }, { "title": "unRAID Docker Memory Limits", "url": "/posts/unraid-docker-memory-limits/", "categories": "unraid", "tags": "unraid, docker, memory, ram", "date": "2022-05-03 10:00:00 +0100", "snippet": "unRAID Docker Memory LimitsSet Memory/RAM limits on a per container basis within unRAID Docker. Docker Edit Container Advanced View Extra Parameters --restart=unless-stopped --memory=1G" }, { "title": "unRAID Wake on LAN", "url": "/posts/unraid-wake-on-lan/", "categories": "unraid", "tags": "unraid, wol, wake, lan", "date": "2022-05-01 10:00:00 +0100", "snippet": "unRAID Wake on LANUser script to force enable Wake on LAN every time unRAID server shuts down. Must be enabled within BIOS already (Power on via PCIe/LAN) Requires the ‘User Scripts’ Community Apps Plugin Settings User Scripts Add New Script activate-wol#!/bin/bashethtool -s eth0 wol gRun in background: At Startup of ArrayExample WoL Client ConfigurationProfile: unRAIDIP: 10.0.0.11Port: 9MAC Addr: XX:XX:XX:XX:XX:XX" }, { "title": "UISP Docker Container", "url": "/posts/uisp-docker/", "categories": "docker", "tags": "docker, unifi, uisp, edgerouter", "date": "2022-04-22 10:00:00 +0100", "snippet": "Docker UISP (formerly UNMS)This is an all-in-one Docker image for running the Ubiquiti Network Management System. This image contains all the components required to run UISP in a single container and uses the s6-overlay for process management.Usagedocker run \\ -p 80:80 \\ -p 443:443 \\ -p 2055:2055/udp \\ -e TZ=&lt;timezone&gt; \\ -v /home/docker/uisp:/config \\ nico640/docker-unms:latestRaspberry Pi / ARMThis image will also allow you to run UISP on a Raspberry Pi or other Docker-enabled ARMv7/8 devices.docker run -d --name uisp -p 80:80 -p 443:443 -p 2055:2055/udp -v /home/docker/uisp:/config nico640/docker-unms:latestParametersThe parameters are split into two halves, separated by a colon, the left hand side representing the host and the right the container side. -v &lt;/path/to/config&gt;:/config - The persistent data location, the database, certs and logs will be stored here -p 80:80 - Expose the HTTP web server port on the docker host -p 443:443 - Expose the HTTPS and WSS web server port on the docker host -p 2055:2055/udp - Expose the Netflow port on the docker host -e TZ=Europe/London - for timezone informationOptional Settings: -e DEMO=false - Enable UISP demo mode -e PUBLIC_HTTPS_PORT=443 - This should match the HTTPS port your are exposing to on the docker host -e PUBLIC_WS_PORT=443 - This should match the HTTPS port your are exposing to on the docker host -e SSL_CERT= - Filename of custom SSL certificate in /config/usercert/ -e SSL_CERT_KEY= - Filename of custom SSL key in /config/usercert/ -e PUID=911 - User ID of the container user -e PGID=911 - Group ID of the container userLimitations In-app upgrades will not work. You can upgrade UISP by downloading the latest version of this image.Docker Composeversion: '2'services: unms: image: nico640/docker-unms:latest restart: always ports: - 80:80 - 443:443 - 2055:2055/udp environment: - TZ=Europe/London volumes: - /home/docker/uisp:/config" }, { "title": "Vigor Modem to Prometheus", "url": "/posts/vigor-to-prometheus/", "categories": "docker", "tags": "docker, python, vigor, modem, draytek, prometheus", "date": "2022-04-07 10:00:00 +0100", "snippet": "Vigor Modem to PrometheusA python script to read the detailed DrayTek router stats.The following stats are recorded and presented as Open Metrics (Prometheus) stats.&gt; vdsl status more ---------------------- ATU-R Info (hw: annex A, f/w: annex A/B/C) ----------- Near End Far End Note Trellis : 1 1 Bitswap : 1 1 ReTxEnable : 1 1 VirtualNoise : 0 0 20BitSupport : 0 0 LatencyPath : 0 0 LOS : 0 0 LOF : 0 0 LPR : 0 0 LOM : 0 0 SosSuccess : 0 0 NCD : 0 0 LCD : 0 0 FECS : 0 2575 (seconds) ES : 35 3 (seconds) SES : 3 1 (seconds) LOSS : 0 0 (seconds) UAS : 27 1861 (seconds) HECError : 0 0 CRC : 126 31 RsCorrection : 0 0 INP : 230 160 (symbols) InterleaveDelay : 0 62 (1/100 ms) NFEC : 32 32 RFEC : 16 16 LSYMB : 16 16 INTLVBLOCK : 32 32 AELEM : 0 ----Environment VariablesThe script requires some environment variables to be loaded, i do this in docker using a .env config file:IP=192.168.100.1USERNAME=adminPASSWORD=adminSERVER_PORT=8081METRICS_PORT=8001TELNET_CMD=/usr/bin/telnetSPAWN_TIMEOUT=5TelnetThe script spawns a telnet connection to the router to gather the stats from the CLI (It could be easily changed to use SSH)The remote prometheus call to /metrics, fires off the telnet request, so this will poll as fast as you want it to.Python ModulesPython Expect (to gather the stats)Template Text Parser (to parse the stats)Prometheus Python Client (to make them available to Prometheus)PrometheusSet as a target as normal.- job_name: router_stats honor_timestamps: true scrape_interval: 5m scrape_timeout: 10s metrics_path: /metrics scheme: http static_configs: - targets: - 192.168.0.1:8003Dockerfile and ScriptdockerfileFROM python:3-slimRUN set -eux; \\ useradd -ms /bin/bash puser; \\ pip install prometheus_client pexpect ttp; \\ apt update; \\ apt-get install -y --no-install-recommends \\ curl \\ telnet \\ &amp;&amp; rm -rf /var/lib/apt/lists/* ; \\ echo \"Done\"# run as non-root user - safety first!USER puserWORKDIR /home/puser# copy code into imageCOPY . /home/puser/# fix for https://github.com/dmulyalin/ttp/issues/54ENV TTPCACHEFOLDER=/tmpENV IP=\"192.168.200.1\"ENV USERNAME=\"admin\"ENV PASSWORD=\"admin\"ENV SERVER_PORT=8081ENV METRICS_PORT=8001# where does telnet live?ENV TELNET_CMD='/usr/bin/telnet' # timeout to telnet to router and grab statsENV SPAWN_TIMEOUT=5EXPOSE 8081EXPOSE 8001# and run the code :)ENTRYPOINT [\"python3\"]CMD [\"vigor-to-prom.py\"]vigor-to-prom.py#!/usr/bin/python3## A python OpenMetrics / Prometheus server to grab data from a DrayTek router## Uses 'expect' to gather data from the telnet port# https://www.draytek.co.uk/support/guides/kb-dsl-status-more# https://kitz.co.uk/adsl/linestats_errors.htmfrom os import getenvimport http.serverfrom prometheus_client import start_http_serverfrom prometheus_client import Summary, Gaugefrom prometheus_client.core import CounterMetricFamily, REGISTRYimport pexpect # expectfrom ttp import ttp # templating# https://prometheus.io/docs/concepts/metric_types/CUSTOM_COUNTERS = { 'ne_LOS': 'Loss Of Signal count', 'ne_LOF': 'Loss Of Frame count', 'ne_LPR': 'Loss Of Power count', 'ne_LOM': 'Loss Of Margin count', 'ne_NCD': 'No Cell Delineation failure count', 'ne_LCD': 'Loss Of Cell Delineation failure count', 'ne_CRC': 'Cyclic Redundancy Check error count, number of CRC 8 anomalies (number of incorrect CRC)', 'ne_HECError': 'Header Error Check Error count, HEC anomalies in the ATM Data Path', 'fe_LOS': 'Loss Of Signal count', 'fe_LOF': 'Loss Of Frame count', 'fe_LPR': 'Loss Of Power count', 'fe_LOM': 'Loss Of Margin count', 'fe_NCD': 'No Cell Delineation failure count', 'fe_LCD': 'Loss Of Cell Delineation failure count', 'fe_CRC': 'Cyclic Redundancy Check error count, number of CRC 8 anomalies (number of incorrect CRC)', 'fe_HECError': 'Header Error Check Error count, HEC anomalies in the ATM Data Path', }LATENCY = Summary('server_latency_gather_router_data_seconds', 'Time to get stats from the router')NE_FECS = Gauge('router_ne_fecs','Forward Error Correction Seconds - Line far-end (FECS-LFE)')NE_ES = Gauge('router_ne_es','Errored Seconds - Line far-end (ES-LFE)')NE_SES\t = Gauge('router_ne_ses','Severely Errored Seconds - Line far-end (SES-LFE)')NE_LOSS = Gauge('router_ne_loss','Loss Of Signal Seconds')NE_UAS\t = Gauge('router_ne_uas','Un-Available Seconds - Line (UAS-L) &amp; Unavailable Seconds - Line far-end (UAS-LFE)')FE_FECS = Gauge('router_fe_fecs','Forward Error Correction Seconds - Line far-end (FECS-LFE)')FE_ES = Gauge('router_fe_es','Errored Seconds - Line far-end (ES-LFE)')FE_SES\t = Gauge('router_fe_ses','Severely Errored Seconds - Line far-end (SES-LFE)')FE_LOSS = Gauge('router_fe_loss','Loss Of Signal Seconds')FE_UAS\t = Gauge('router_fe_uas','Un-Available Seconds - Line (UAS-L) &amp; Unavailable Seconds - Line far-end (UAS-LFE)')DSL_UPDOWN = Gauge('router_up_down','1=up \"SHOWTIME\", 0=down anything else', ['status'])#TODO: add some info gauges for the static text ext_template = \"\"\"&lt;group name=\"rs\"&gt; ---------------------- ATU-R Info (hw: annex , f/w: annex ) ----------- Near End Far End Note Trellis : Bitswap : ReTxEnable : VirtualNoise : 20BitSupport : LatencyPath : LOS : LOF : LPR : LOM : SosSuccess : NCD : LCD : FECS : (seconds) ES : (seconds) SES : (seconds) LOSS : (seconds) UAS : (seconds) HECError : CRC : INP : (symbols) INTLVDelay : (1/100 ms) NFEC : RFEC : LSYMB : INTLVBLOCK : AELEM : ----&lt;/group&gt;\"\"\"wan_template = \"\"\"&lt;group name=\"wan\"&gt;Link Status: Firmware Version: VDSL2 Profile: Basic\tStatus\tUpstream\tDownstream Actual Data Rate: SNR: G.Vectoring Status:\t&lt;/group&gt;\"\"\"class RouterCollector(object):## Prometheus stuff, called when ever the METRICS_PORT is opened# @LATENCY.time() # measure who long this function takes to run def collect(self): print(\"Gathering router stats...\") try: child = pexpect.spawn (config.TELNET_CMD + ' ' + config.IP, timeout=config.SPAWN_TIMEOUT) child.expect(\"Account:\") child.send (config.USERNAME +\"\\r\") child.expect (\"Password: \") child.send (config.PASSWORD+\"\\r\") child.expect (\"DrayTek&gt; \") child.send (\"wan vdsl show basic\\r\") child.expect (\"DrayTek&gt; \") wan_results = child.before wan_results=str(wan_results.replace(b'\\r',b''),'ascii') # convert to ascii string for parsing parser = ttp(data=wan_results, template=wan_template, log_level='INFO') parser.parse() # extract the info wm = parser.result(format='raw')[0][0] link_status = wm['wan']['link_status'] if link_status == \"SHOWTIME\": DSL_UPDOWN.labels(link_status).set(1) else: DSL_UPDOWN.labels(link_status).set(0) child.send (\"vdsl status more\\r\") child.expect (\"DrayTek&gt; \") ext_results = child.before child.send (\"exit\\r\") ext_results=str(ext_results.replace(b'\\r',b''),'ascii') # convert to ascii string for parsing #print(ext_results) parser = ttp(data=ext_results, template=ext_template, log_level='INFO') parser.parse() # extract the info # print result in JSON format #p_ext_results = parser.result(format='json')[0] #print(p_ext_results) om = parser.result(format='raw')[0][0] #print(om) # Load up the Prometheus custom counters for c in CUSTOM_COUNTERS: #print(\"{} | {} | {}\".format(c, CUSTOM_COUNTERS[c], om['rs'][c])) yield CounterMetricFamily(\"router_\" + c, CUSTOM_COUNTERS[c], om['rs'][c]) # load up the standard gauges - everything that is returned in seconds NE_FECS.set(om['rs']['ne_FECS']) NE_ES.set(om['rs']['ne_ES']) NE_SES.set(om['rs']['ne_SES']) NE_LOSS.set(om['rs']['ne_LOSS']) NE_UAS.set(om['rs']['ne_UAS']) FE_FECS.set(om['rs']['fe_FECS']) FE_ES.set(om['rs']['fe_ES']) FE_SES.set(om['rs']['fe_SES']) FE_LOSS.set(om['rs']['fe_LOSS']) FE_UAS.set(om['rs']['fe_UAS']) except Exception as e: print(\"Error gathering stats:\", e) returnclass ServerHandler(http.server.BaseHTTPRequestHandler):## Web Browser stuff# def do_GET(self): self.send_response(200) self.end_headers() self.wfile.write(\"Prometheus metrics available on port {} /metrics\\n\".format(config.METRICS_PORT).encode(\"utf-8\")) # a byte stringclass Config(object): def __init__(self): # read in environment variables self.IP=getenv('IP','192.168.0.1') self.USERNAME=getenv('USERNAME','admin') self.PASSWORD=getenv('PASSWORD','password') self.SERVER_PORT=int(getenv('SERVER_PORT', '8081')) self.METRICS_PORT=int(getenv('METRICS_PORT','8001')) self.TELNET_CMD=getenv('TELNET_CMD','/usr/bin/telnet') # where does telnet live? self.SPAWN_TIMEOUT=int(getenv('SPAWN_TIMEOUT',5))if __name__ == \"__main__\": # read in config from Environment Variables config = Config() #print(config.IP,config.USERNAME,config.PASSWORD,config.SPAWN_TIMEOUT) # this is called everytime the /metrics URI is called REGISTRY.register(RouterCollector()) # start metrics server start_http_server(config.METRICS_PORT) # start web server - keeps the app up and running server = http.server.HTTPServer(('', config.SERVER_PORT), ServerHandler) print(\"Prometheus metrics available on port \"+str(config.METRICS_PORT)+\" /metrics\") print(\"HTTP server available on port \"+str(config.SERVER_PORT)) server.serve_forever()https://github.com/mohclips/draytek_router_stats_prometheus" }, { "title": "Vigor to Telegraf", "url": "/posts/vigor-to-telegraf/", "categories": "docker", "tags": "docker, python, vigor, modem, draytek, telegraf", "date": "2022-04-06 10:00:00 +0100", "snippet": "Vigor to TelegrafInstallation Copy script vigor-to-telegraf.py to a directory accessible by Telegraf Make the script executable chmod +x vigor-to-telegraf.py Edit the script variablesusername = \"admin\"password = \"admin\"host = '192.168.100.1'timeout = 2 Append the Input to telegraf.conf[[inputs.exec]] commands = [\"python3 /opt/telegraf/vigor-to-telegraf.py\"] timeout = \"15s\" data_format = \"influx\"5a. Ensure Telegraf has Python accessible (Install if in Docker Container)apt-get upgrade -y &amp;&amp; apt-get install -y python3 python3-pip5b. Restart telegrafScriptvigor-to-telegraf.py#!/usr/bin/python3from telnetlib import Telnetimport timeimport reusername = \"admin\"password = \"admin\"host = '192.168.100.1'timeout = 2with Telnet(host, 23) as tn: tn.read_until(b\"Account:\", timeout) tn.write(username.encode('ascii') + b\"\\n\") tn.read_until(b\"Password: \", timeout) tn.write(password.encode('ascii') + b\"\\n\") tn.read_until(b\"Vigor&gt; \", timeout) tn.write(b\"vdsl status\\n\") status = tn.read_until(b\"Vigor&gt; \", timeout) tn.write(b\"vdsl status more\\n\") statusmore = tn.read_until(b\"Vigor&gt; \", timeout) for line in status.splitlines(): if(match := re.search('\\s+DS Actual Rate\\s+:\\s+(\\d+) bps\\s+US Actual Rate\\s+:\\s+(\\d+) bps', line.decode())): act_rate_down = int(match.group(1)) act_rate_up = int(match.group(2)) if(match := re.search('\\s+DS Attainable Rate\\s+:\\s+(\\d+) bps\\s+US Attainable Rate\\s+:\\s+(\\d+) bps', line.decode())): att_rate_down = int(match.group(1)) att_rate_up = int(match.group(2)) if(match := re.search('\\s+DS Interleave Depth\\s+:\\s+(\\d+)\\s+US Interleave Depth\\s+:\\s+(\\d+)\\s+', line.decode())): intl_down = int(match.group(1)) intl_up = int(match.group(2)) if(match := re.search('\\s+NE Current Attenuation\\s+:\\s+(\\d+)\\s+dB\\s+Cur SNR Margin\\s+:\\s+(\\d+)\\s+dB', line.decode())): atten_down = int(match.group(1)) snr_down = int(match.group(2)) if(match := re.search('\\s+Far Current Attenuation\\s+:\\s+(\\d+)\\s+dB\\s+Far SNR Margin\\s+:\\s+(\\d+)\\s+dB', line.decode())): atten_up = int(match.group(1)) snr_up = int(match.group(2)) for line in statusmore.splitlines(): if(match := re.search('\\s+FECS\\s+:\\s+(\\d+)\\s+(\\d+) \\(seconds\\)', line.decode())): fec_down = int(match.group(1)) fec_up = int(match.group(2)) if(match := re.search('\\s+ES\\s+:\\s+(\\d+)\\s+(\\d+) \\(seconds\\)', line.decode())): es_down = int(match.group(1)) es_up = int(match.group(2)) if(match := re.search('\\s+SES\\s+:\\s+(\\d+)\\s+(\\d+) \\(seconds\\)', line.decode())): ses_down = int(match.group(1)) ses_up = int(match.group(2)) if(match := re.search('\\s+CRC\\s+:\\s+(\\d+)\\s+(\\d+)', line.decode())): crc_down = int(match.group(1)) crc_up = int(match.group(2)) es_down_total = es_down + ses_down es_up_total = es_up + ses_up print(f\"vdslstats,host={host} act_rate_down={act_rate_down},act_rate_up={act_rate_up},att_rate_down={att_rate_down},att_rate_up={att_rate_up},intl_down={intl_down},intl_up={intl_up},atten_down={atten_down},snr_down={snr_down},atten_up={atten_up},snr_up={snr_up},fec_down={fec_down},fec_up={fec_up},es_down={es_down},es_up={es_up},ses_down={ses_down},ses_up={ses_up},crc_down={crc_down},crc_up={crc_up}\") print(\"\", end='', flush=True)" }, { "title": "Wireshark over SSH", "url": "/posts/ssh-wireshark-monitoring/", "categories": "edgerouter", "tags": "edgerouter, wireshark, ssh, monitor", "date": "2022-03-19 09:00:00 +0000", "snippet": "Traffic monitoring over SSHLinuxssh ubnt@egderouter_ip 'sudo tcpdump -f -i eth0 -w -' | wireshark -k -i -ssh ubnt@egderouter_ip 'sudo tcpdump -f -i eth0 -w - not port 22' | wireshark -k -i -Windowsssh ubnt@egderouter_ip \"sudo tcpdump -f -i eth0 -w -\" | \"C:\\Program Files\\Wireshark\\Wireshark.exe\" -k -i -" }, { "title": "Edgerouter IoT Segregation", "url": "/posts/edgerouter-iot-segregation/", "categories": "edgerouter", "tags": "edgerouter, iot, segregation, vlan", "date": "2022-02-15 09:00:00 +0000", "snippet": "EdgeRouter-Home-Network (Guest &amp; IoT Isolation)EdgeRouter CLI Commands For A Segregated Home NetworkConfigure ModeconfigureCreate VLAN’s for the Networkset interfaces ethernet eth0 description 'Internet (ISP)'set interfaces ethernet eth1 description 'Lan Network'set interfaces ethernet eth1 vif 10 address 10.10.10.1/24set interfaces ethernet eth1 vif 10 description 'Main Network'set interfaces ethernet eth1 vif 20 address 10.10.20.1/24set interfaces ethernet eth1 vif 20 description 'Guest Network'set interfaces ethernet eth1 vif 30 address 10.10.30.1/24set interfaces ethernet eth1 vif 30 description 'IoT Network''commitCreate DHCP Server for VLAN’sset service dhcp-server disabled falseset service dhcp-server shared-network-name Main-V10set service dhcp-server shared-network-name Main-V10 authoritative enableset service dhcp-server shared-network-name Main-V10 subnet 10.10.10.0/24 default-router 10.10.10.1set service dhcp-server shared-network-name Main-V10 subnet 10.10.10.0/24 dns-server 8.8.8.8set service dhcp-server shared-network-name Main-V10 subnet 10.10.10.0/24 lease 86400set service dhcp-server shared-network-name Main-V10 subnet 10.10.10.0/24 start 10.10.10.11 stop 10.10.10.210set service dhcp-server shared-network-name Guest-V20set service dhcp-server shared-network-name Guest-V20 authoritative enableset service dhcp-server shared-network-name Guest-V20 subnet 10.10.20.0/24 default-router 10.10.20.1set service dhcp-server shared-network-name Guest-V20 subnet 10.10.20.0/24 dns-server 8.8.8.8set service dhcp-server shared-network-name Guest-V20 subnet 10.10.20.0/24 lease 86400set service dhcp-server shared-network-name Guest-V20 subnet 10.10.20.0/24 start 10.10.20.11 stop 10.10.20.210set service dhcp-server shared-network-name IoT-V30set service dhcp-server shared-network-name IoT-V30 authoritative enableset service dhcp-server shared-network-name IoT-V30 subnet 10.10.30.0/24 default-router 10.10.30.1set service dhcp-server shared-network-name IoT-V30 subnet 10.10.30.0/24 dns-server 8.8.8.8set service dhcp-server shared-network-name IoT-V30 subnet 10.10.30.0/24 lease 86400set service dhcp-server shared-network-name IoT-V30 subnet 10.10.30.0/24 start 10.10.30.11 stop 10.10.30.210commitSet up FIREWALL for Guest &amp; IOT VLAN’sCreate Network Groupset firewall group network-group LAN_NETWORKS description 'Private Network Group'set firewall group network-group LAN_NETWORKS network 192.168.0.0/16set firewall group network-group LAN_NETWORKS network 172.16.0.0/12set firewall group network-group LAN_NETWORKS network 10.0.0.0/8commitSet up rules for GUEST VLANset firewall name GUEST_INset firewall name GUEST_IN description 'Guest to Internet' set firewall name GUEST_IN default-action acceptset firewall name GUEST_IN rule 10 action acceptset firewall name GUEST_IN rule 10 description 'Allow'set firewall name GUEST_IN rule 10 protocol allset firewall name GUEST_IN rule 10 state established enableset firewall name GUEST_IN rule 10 state related enableset firewall name GUEST_IN rule 20 action dropset firewall name GUEST_IN rule 20 description 'Drop'set firewall name GUEST_IN rule 20 destination group network-group LAN_NETWORKSset firewall name GUEST_IN rule 20 protocol allset firewall name GUEST_LOCALset firewall name GUEST_LOCAL description 'Guest to Internet'set firewall name GUEST_LOCAL default-action dropset firewall name GUEST_LOCAL rule 10 action acceptset firewall name GUEST_LOCAL rule 10 description 'Allow DNS'set firewall name GUEST_LOCAL rule 10 log disableset firewall name GUEST_LOCAL rule 10 protocol tcp_udpset firewall name GUEST_LOCAL rule 10 destination port 53set firewall name GUEST_LOCAL rule 20 action acceptset firewall name GUEST_LOCAL rule 20 description 'Allow DHCP'set firewall name GUEST_LOCAL rule 20 log disableset firewall name GUEST_LOCAL rule 20 protocol udpset firewall name GUEST_LOCAL rule 20 destination port 67commitSet up rules for IOT VLANset firewall name IoT_INset firewall name IoT_IN description 'IoT to Internet' set firewall name IoT_IN default-action acceptset firewall name IoT_IN rule 10 action acceptset firewall name IoT_IN rule 10 description 'Allow'set firewall name IoT_IN rule 10 protocol allset firewall name IoT_IN rule 10 state established enableset firewall name IoT_IN rule 10 state related enableset firewall name IoT_IN rule 20 action dropset firewall name IoT_IN rule 20 description 'Drop'set firewall name IoT_IN rule 20 destination group network-group LAN_NETWORKSset firewall name IoT_IN rule 20 protocol allset firewall name IoT_LOCALset firewall name IoT_LOCAL description 'IoT to Internet'set firewall name IoT_LOCAL default-action dropset firewall name IoT_LOCAL rule 10 action acceptset firewall name IoT_LOCAL rule 10 description 'Allow DNS'set firewall name IoT_LOCAL rule 10 log disableset firewall name IoT_LOCAL rule 10 protocol tcp_udpset firewall name IoT_LOCAL rule 10 destination port 53set firewall name IoT_LOCAL rule 20 action acceptset firewall name IoT_LOCAL rule 20 description 'Allow DHCP'set firewall name IoT_LOCAL rule 20 log disableset firewall name IoT_LOCAL rule 20 protocol udpset firewall name IoT_LOCAL rule 20 destination port 67commitAssign the VLAN interfacesset interfaces ethernet eth1 vif 20 firewall in name GUEST_INset interfaces ethernet eth1 vif 20 firewall local name GUEST_LOCALset interfaces ethernet eth1 vif 30 firewall in name IoT_INset interfaces ethernet eth1 vif 30 firewall local name IoT_LOCALcommitsave" }, { "title": "Edgerouter IPv6 over PPPoE", "url": "/posts/edgerouter-ipv6-bt-fttc/", "categories": "edgerouter", "tags": "router, ipv6, edgerouter, bt, pppoe", "date": "2022-01-01 09:00:00 +0000", "snippet": "Edgerouter IPv6 over PPPoEEnable IPv6 on PPPoEset interfaces ethernet eth0 pppoe 0 ipv6 enableset interfaces ethernet eth0 pppoe 0 ipv6 address autoconfset interfaces ethernet eth0 pppoe 0 ipv6 dup-addr-detect-transmits 1set interfaces ethernet eth0 pppoe 0 dhcpv6-pd pd 0 prefix-length /56set interfaces ethernet eth0 pppoe 0 dhcpv6-pd rapid-commit enableset interfaces ethernet eth0 pppoe 0 dhcpv6-pd prefix-onlyFirewall Rules for IPv6Only allow:Established ConnectionsRelated ConnectionsICMPv6 (Ping)DHCPv6 (ISP Address Assignment)set firewall ipv6-name WANv6_LOCAL default-action dropset firewall ipv6-name WANv6_LOCAL description 'Local network traffic'set firewall ipv6-name WANv6_LOCAL enable-default-logset firewall ipv6-name WANv6_LOCAL rule 10 action acceptset firewall ipv6-name WANv6_LOCAL rule 10 description 'Allow established/related sessions'set firewall ipv6-name WANv6_LOCAL rule 10 state established enableset firewall ipv6-name WANv6_LOCAL rule 10 state related enableset firewall ipv6-name WANv6_LOCAL rule 20 action dropset firewall ipv6-name WANv6_LOCAL rule 20 description 'Drop invalid state'set firewall ipv6-name WANv6_LOCAL rule 20 state invalid enableset firewall ipv6-name WANv6_LOCAL rule 30 action acceptset firewall ipv6-name WANv6_LOCAL rule 30 description 'Allow IPv6 icmp'set firewall ipv6-name WANv6_LOCAL rule 30 protocol icmpv6set firewall ipv6-name WANv6_LOCAL rule 40 action acceptset firewall ipv6-name WANv6_LOCAL rule 40 description 'allow dhcpv6'set firewall ipv6-name WANv6_LOCAL rule 40 destination port 546set firewall ipv6-name WANv6_LOCAL rule 40 protocol udpset firewall ipv6-name WANv6_LOCAL rule 40 source port 547set firewall ipv6-name WANv6_LOCAL default-action dropset firewall ipv6-name WANv6_LOCAL description 'WAN inbound traffic to the router'set firewall ipv6-name WANv6_IN enable-default-logset firewall ipv6-name WANv6_IN rule 10 action acceptset firewall ipv6-name WANv6_IN rule 10 description 'Allow established/related sessions'set firewall ipv6-name WANv6_IN rule 10 state established enableset firewall ipv6-name WANv6_IN rule 10 state related enableset firewall ipv6-name WANv6_IN rule 20 action dropset firewall ipv6-name WANv6_IN rule 20 description 'Drop invalid state'set firewall ipv6-name WANv6_IN rule 20 state invalid enableset firewall ipv6-name WANv6_IN rule 30 action acceptset firewall ipv6-name WANv6_IN rule 30 description 'Allow IPv6 icmp'set firewall ipv6-name WANv6_IN rule 30 protocol icmpv6set firewall ipv6-name WANv6_IN rule 40 action acceptset firewall ipv6-name WANv6_IN rule 40 description 'allow dhcpv6'set firewall ipv6-name WANv6_IN rule 40 destination port 546set firewall ipv6-name WANv6_IN rule 40 protocol udpset firewall ipv6-name WANv6_IN rule 40 source port 547set interfaces ethernet eth0 pppoe 0 firewall in ipv6-name WANv6_INset interfaces ethernet eth0 pppoe 0 firewall in name WAN_INset interfaces ethernet eth0 pppoe 0 firewall local ipv6-name WANv6_LOCALset interfaces ethernet eth0 pppoe 0 firewall local name WAN_LOCALIPv6 SLAACEnable IPv6 Stateless Address Auto Configuration on LAN (Switch0)set interfaces ethernet eth0 pppoe 0 dhcpv6-pd pd 0 interface switch0 host-address '::1'set interfaces ethernet eth0 pppoe 0 dhcpv6-pd pd 0 interface switch0 prefix-id '::1'set interfaces ethernet eth0 pppoe 0 dhcpv6-pd pd 0 interface switch0 service slaacEnable IPv6 on LAN (Switch0)set interfaces switch switch0 ipv6 dup-addr-detect-transmits 1set interfaces switch switch0 ipv6 router-advert cur-hop-limit 64set interfaces switch switch0 ipv6 router-advert link-mtu 0set interfaces switch switch0 ipv6 router-advert managed-flag falseset interfaces switch switch0 ipv6 router-advert max-interval 600set interfaces switch switch0 ipv6 router-advert other-config-flag falseset interfaces switch switch0 ipv6 router-advert prefix '::/64' autonomous-flag trueset interfaces switch switch0 ipv6 router-advert prefix '::/64' on-link-flag trueset interfaces switch switch0 ipv6 router-advert prefix '::/64' valid-lifetime 2592000set interfaces switch switch0 ipv6 router-advert reachable-time 0set interfaces switch switch0 ipv6 router-advert retrans-timer 0set interfaces switch switch0 ipv6 router-advert send-advert truehttp://test-ipv6.com/https://grh.am/2018/ipv6-with-bt-infinity-and-an-edgerouter-x/" }, { "title": "Static Host Mappings on Edgerouter", "url": "/posts/edgerouter-static-host-mappings/", "categories": "edgerouter", "tags": "edgerouter, dns, static, hostname", "date": "2021-12-10 09:00:00 +0000", "snippet": "Static Host Mappings on EdgeRouter-Xconfigureshow system static-host-mappingexitAdding a Mapping with Alias:configureset system static-host-mapping host-name pi.hole inet 192.168.1.8set system static-host-mapping host-name pi.hole alias piholecommitsaveexitRemoving Mapping with Aliases:configuredelete system static-host-mapping host-name pi.holecommitsaveexit" }, { "title": "PiHole MACVLAN Network Creation", "url": "/posts/pihole-macvlan/", "categories": "pi", "tags": "pi, pihole, macvlan, bridge, network, docker", "date": "2021-04-25 10:00:00 +0100", "snippet": "Pi-Hole Docker macvlan Network SetupCreate Networkip link add macvlan0 link eth0 type macvlan mode bridgeip addr add 192.168.1.9 dev macvlan0ip link set macvlan0 updocker network create --driver=macvlan --gateway=192.168.1.254 --subnet=192.168.1.1/24 -o parent=eth0 macvlan0" }, { "title": "Destiny 2 Solo Script", "url": "/posts/destiny-2-solo-script/", "categories": "gaming", "tags": "destiny, gaming", "date": "2021-02-13 09:00:00 +0000", "snippet": "Destiny 2 Solo ScriptScript to enable solo play within Destiny 2 PC by blocking multiplayer ports within the firewall.Works with both Steam and Windows versions of the game as of The Witch Queen DLC. Must be enabled whilst in orbit alreadyRun the script within Powershell/Windows Terminal to enable, and hit Enter to disable and remove the firewall rules.destiny-2-solo.ps1 Downloadif (!([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] \"Administrator\")) { Start-Process powershell.exe \"-NoProfile -ExecutionPolicy Bypass -File `\"$PSCommandPath`\"\" -Verb RunAs; exit }New-NetFirewallRule -DisplayName \"Destiny2-Solo-1\" -Direction Outbound -LocalPort 27000-27100 -Protocol TCP -Action BlockNew-NetFirewallRule -DisplayName \"Destiny2-Solo-2\" -Direction Outbound -LocalPort 27000-27100 -Protocol UDP -Action BlockNew-NetFirewallRule -DisplayName \"Destiny2-Solo-3\" -Direction Inbound -LocalPort 27000-27100 -Protocol TCP -Action BlockNew-NetFirewallRule -DisplayName \"Destiny2-Solo-4\" -Direction Inbound -LocalPort 27000-27100 -Protocol UDP -Action BlockWrite-Host \"Destiny 2 Solo Enabled\"Read-HostRemove-NetFirewallRule -DisplayName \"Destiny2-Solo-1\" Remove-NetFirewallRule -DisplayName \"Destiny2-Solo-2\" Remove-NetFirewallRule -DisplayName \"Destiny2-Solo-3\" Remove-NetFirewallRule -DisplayName \"Destiny2-Solo-4\"" }, { "title": "365 Domain Removal and Revert", "url": "/posts/365-domain-removal-revert/", "categories": "365", "tags": "script, domain, 365", "date": "2021-01-22 09:00:00 +0000", "snippet": "365 Domain Removal and RevertScript to remove existing primary domain and revert to .onmicrosoft or other specified domain.Specify Domains and Connect to 365$olddomain =\"docs.nels.one\"$Newdomain=\"nels.onmicrosoft.com\"Import-Module MsOnline$credential = get-credentialConnect-MsolService -Credential $credentialReplace Existing UPN’s$users=Get-MsolUser -domain $olddomain$users | Foreach-Object{ $user=$_$UserName =($user.UserPrincipalName -split \"@\")[0]$UPN= $UserName+\"@\"+ $Newdomain Set-MsolUserPrincipalName -UserPrincipalName $user.UserPrincipalName -NewUserPrincipalName $UPN}Remove Address from Existing MailboxesConnect-ExchangeOnline$Mailboxes = Get-Mailbox -ResultSize Unlimitedforeach ($Mailbox in $Mailboxes) { $Mailbox.EmailAddresses | Where-Object { ($_ -like \"*@docs.nels.one\") } | ForEach-Object { Set-Mailbox $Mailbox.Name -EmailAddresses @{remove = $_ } Write-Host \"Removing $_ from $Mailbox Mailbox\" -ForegroundColor Green }}" }, { "title": "Edgerouter UPnP2 Configuration", "url": "/posts/edgerouter-upnp2/", "categories": "edgerouter", "tags": "edgerouter, upnp2, upnp, open, nat", "date": "2020-10-13 10:00:00 +0100", "snippet": "Edgerouter UPnP2 ConfigurationDelete Existing UPnPconfiguredelete service upnpcommitsaveexitEnable UPnP2 for LAN (switch0)configureset service upnp2 listen-on switch0set service upnp2 wan pppoe0set service upnp2 secure-mode enableset service upnp2 nat-pmp enablecommitsaveexitOpen NAT Xboxconfigureset service upnp2 acl rule 10 action denyset service upnp2 acl rule 10 external-port 3074set service upnp2 acl rule 10 local-port 0-65535set service upnp2 acl rule 10 subnet 10.0.0.0/24set service upnp2 acl rule 10 description Xbox 3074 Denycommitsaveexit" }, { "title": "Disable LEDs on Raspberry Pi's", "url": "/posts/pi-disable-leds/", "categories": "pi", "tags": "pi, led, ethernet", "date": "2020-08-01 10:00:00 +0100", "snippet": "Disable LEDs on Raspberry PiEdit the Boot Configsudo nano /boot/config.txtTurn off PWR LEDdtparam=pwr_led_trigger=nonedtparam=pwr_led_activelow=offTurn off ACT LEDdtparam=act_led_trigger=nonedtparam=act_led_activelow=offTurn off Ethernet ACT LEDPi4dtparam=eth_led0=4Pi3Bdtparam=eth_led0=14Turn off Ethernet LNK LEDPi4dtparam=eth_led1=4Pi3Bdtparam=eth_led1=14" }, { "title": "Organizr Docker Configuration", "url": "/posts/organizr-docker/", "categories": "docker", "tags": "docker, organizr, homelab, tabs", "date": "2020-02-24 09:00:00 +0000", "snippet": "Organizr Docker Configurationdocker-compose.ymlversion: \"3\"services: organizr: container_name: organizr entrypoint: - /init hostname: organizr image: organizr/organizr:latest ports: - 8001:80/tcp restart: unless-stopped volumes: - /home/docker/organizr:/config" }, { "title": "Grafana Docker Configuration", "url": "/posts/grafana-docker/", "categories": "docker", "tags": "docker, grafana", "date": "2020-02-19 09:00:00 +0000", "snippet": "Grafana Docker Configurationdocker-compose.ymlversion: \"3\"services: grafana: container_name: grafana entrypoint: - /run.sh hostname: grafana image: grafana/grafana-enterprise:latest ipc: private logging: driver: json-file options: {} ports: - 3000:3000/tcp restart: unless-stopped user: grafana volumes: - /home/docker/grafana/grafana.ini:/etc/grafana/grafana.ini - /home/docker/grafana:/var/lib/grafana working_dir: /usr/share/grafana" }, { "title": "Cloudflare DDNS Docker", "url": "/posts/cloudflare-ddns-docker/", "categories": "docker", "tags": "docker, cloudflare, ddns, domain", "date": "2020-02-13 09:00:00 +0000", "snippet": "Cloudflare DDNS DockerUsageQuick Setup:docker run \\ -e API_KEY=xxxxxxx \\ -e ZONE=example.com \\ -e SUBDOMAIN=subdomain \\ oznu/cloudflare-ddnsParameters --restart=always - ensure the container restarts automatically after host reboot. -e API_KEY - Your CloudFlare scoped API token. See the Creating a Cloudflare API token below. Required API_KEY_FILE - Path to load your CloudFlare scoped API token from (e.g. a Docker secret). If both API_KEY_FILE and API_KEY are specified, API_KEY_FILE takes precedence. -e ZONE - The DNS zone that DDNS updates should be applied to. Required ZONE_FILE - Path to load your CloudFlare DNS Zone from (e.g. a Docker secret). If both ZONE_FILE and ZONE are specified, ZONE_FILE takes precedence. -e SUBDOMAIN - A subdomain of the ZONE to write DNS changes to. If this is not supplied the root zone will be used. SUBDOMAIN_FILE - Path to load your CloudFlare DNS Subdomain from (e.g. a Docker secret). If both SUBDOMAIN_FILE and SUBDOMAIN are specified, SUBDOMAIN_FILE takes precedence. Optional Parameters -e PROXIED - Set to true to make traffic go through the CloudFlare CDN. Defaults to false. -e RRTYPE=A - Set to AAAA to use set IPv6 records instead of IPv4 records. Defaults to A for IPv4 records. -e DELETE_ON_STOP - Set to true to have the dns record deleted when the container is stopped. Defaults to false. -e INTERFACE=tun0 - Set to tun0 to have the IP pulled from a network interface named tun0. If this is not supplied the public IP will be used instead. Requires --network host run argument. -e CUSTOM_LOOKUP_CMD=\"echo '1.1.1.1'\" - Set to any shell command to run them and have the IP pulled from the standard output. Leave unset to use default IP address detection methods. -e DNS_SERVER=10.0.0.2 - Set to the IP address of the DNS server you would like to use. Defaults to 1.1.1.1 otherwise. -e CRON=\"@daily\" - Set your own custom CRON value before the exec portion. Defaults to every 5 minutes - */5 * * * *.Depreciated Parameters -e EMAIL - Your CloudFlare email address when using an Account-level token. This variable MUST NOT be set when using a scoped API token.Creating a Cloudflare API tokenTo create a CloudFlare API token for your DNS zone go to https://dash.cloudflare.com/profile/api-tokens and follow these steps: Click Create Token Provide the token a name, for example, cloudflare-ddns Grant the token the following permissions: Zone - Zone Settings - Read Zone - Zone - Read Zone - DNS - Edit Set the zone resources to: Include - All zones Complete the wizard and copy the generated token into the API_KEY variable for the containerMultiple DomainsIf you need multiple records pointing to your public IP address you can create CNAME records in CloudFlare.IPv6If you’re wanting to set IPv6 records set the envrionment variable RRTYPE=AAAA. You will also need to run docker with IPv6 support, or run the container with host networking enabled.Docker Composedocker-compose.ymlversion: '3'services: cloudflare-ddns: image: oznu/cloudflare-ddns:latest restart: always environment: - API_KEY=xxxxxxx - ZONE=nels.one - SUBDOMAIN=docs - PROXIED=false" }, { "title": "Powershell Custom Desktop Shortcut", "url": "/posts/powershell-custom-desktop-shortcut/", "categories": "script", "tags": "rmm, script, powershell, shortcut", "date": "2020-01-10 09:00:00 +0000", "snippet": "Powershell Custom Desktop ShortcutScript to create a custom shortcut on the Desktop of client machines.custom-shortcut.ps1$Shell = New-Object -ComObject (\"WScript.Shell\")$Favorite = $Shell.CreateShortcut([Environment]::GetFolderPath(\"CommonDesktopDirectory\") + \"\\CustomShortcutName.url\")$Favorite.TargetPath = \"https://docs.nels.one\";$Favorite.Save()" }, { "title": "Outlook Local Signature Removal", "url": "/posts/outlook-local-signature-removal/", "categories": "script", "tags": "rmm, script, outlook, powershell, signature", "date": "2019-09-20 10:00:00 +0100", "snippet": "Outlook Local Signature RemovalLogin ScriptScript to be pushed out via Group Policy to delete any existing signature within Outlook locally.signature-removal.ps1$TopFolder = 'c:\\users'$SigFolder = 'AppData\\Roaming\\Microsoft\\Signatures'$FolderList = Get-ChildItem $TopFolder -Directory -Exclude default, Publicforeach ($Item in $FolderList) { if (Test-Path (Join-Path -Path $Item -ChildPath $SigFolder)) { $compPath = \"$Item\" + \"\\\" + \"$SigFolder\" + \"\\*\" Remove-Item $compPath -Recurse } }" }, { "title": "Psuedo-Ethernet WAN GUI Access", "url": "/posts/psuedoethernet-access-wan-gui/", "categories": "edgerouter", "tags": "edgerouter, modem, masquerade", "date": "2019-07-20 10:00:00 +0100", "snippet": "Psuedo-Ethernet WAN GUI AccessAllows access to modem GUI over LAN Portconfigureset interfaces pseudo-ethernet peth0 link eth0set interfaces pseudo-ethernet peth0 address 192.168.100.1/24set interfaces pseudo-ethernet peth0 description \"Access to modem\"commitsaveexitconfigureset service nat rule 5000 type masqueradeset service nat rule 5000 destination address 192.168.100.1set service nat rule 5000 outbound-interface peth0commitsaveexit" }, { "title": "Commandline Static IP Assignment", "url": "/posts/commandline-static-ip-assignment/", "categories": "script", "tags": "rmm, script, cmd, dns, ip, netsh", "date": "2019-06-14 10:00:00 +0100", "snippet": "Commandline Static IP AssignmentRemotely edit the Static IP Address of a specific interface on a client machine.netsh interface ipv4 show addressnetsh int ip set address \"Ethernet\" static 192.168.1.100 255.255.255.0 192.168.1.254 1" }, { "title": "Commandline DNS Change", "url": "/posts/commandline-dns-change/", "categories": "script", "tags": "rmm, script, cmd, dns, ip, netsh", "date": "2019-06-14 10:00:00 +0100", "snippet": "Commandline DNS ChangeRemotely edit the DNS of a specific interface on a client machine.netsh interface ipv4 show addressnetsh interface ip set dns name=\"Wi-Fi\" static 1.1.1.1netsh interface ip add dns name=\"Wi-Fi\" 8.8.8.8 index=2" }, { "title": "Destiny 2 Wish Wall AHK Script", "url": "/posts/destiny-2-wishwall-ahk/", "categories": "", "tags": "", "date": "2019-04-04 10:00:00 +0100", "snippet": "Destiny 2 Wish Wall AHK ScriptRequirements Divinity AutoHotKey 720p, 1080p, 1440p, or 2160pUsage Open .ahk file Stand on the middle of the Wish plate Aim at the center of the Wish Wall grid Press F3 to open the Wish Wall menu Press F4 to stop the script at any pointdestiny-2-wishwall-f3.ahkF3::global recoil_scalar := 1switch %A_ScreenHeight%{\tcase 720:\trecoil_scalar := 1.5\t\tcase 1080:\trecoil_scalar := 1.3\t\tcase 1440:\trecoil_scalar := 1\t\tcase 2160:\trecoil_scalar := 0.75\t}global pos_x := 0global pos_y := 0global recoil := recoil_scalar * 3.5global cycle_time := 55global res_scalar := 1global sensitivity := 8switch %A_ScreenHeight%{\tcase 720:\tres_scalar := 1.5\t\tcase 1080:\tres_scalar := 1.3\t\tcase 1440:\tres_scalar := 1\t\tcase 2160:\tres_scalar := 0.75\t}global WishNumberInputBox, WishNumber, Wish Selector, Wish Wall MenuR `n`n1. Ethereal Key (once per account)`n2. Glittering Key chest spawn`n3. Numbers of Power emblem`n4. Shuro Chi encounter`n5. Morgeth encounter`n6. Vault encounter`n7. Riven encounter`n8. Hope for the Future song`n9. Failsafe dialogue`n10. Drifter dialogue`n11. Party effect on precision kills`n12. Random effect around players' heads`n13. Petra's Run`n14. Corrupted Eggs spawn`n,,300,400\tswitch WishNumber{\tcase 1:\twish1()\t\tcase 2:\twish2()\t\tcase 3:\twish3()\tcase 4:\twish4()\t\tcase 5:\twish5()\t\tcase 6:\twish6()\t\tcase 7:\twish7()\t\tcase 8:\twish8()\t\tcase 9:\twish9()\t\tcase 10:\twish10()\t\tcase 11:\twish11()\t\tcase 12:\twish12()\t\tcase 13:\twish13()\t\tcase 14:\twish14()}jump()Returnwish1(){shoot(3)shoot(4)shoot(5)shoot(9)shoot(10)shoot(18)shoot(11)shoot(12)shoot(16)shoot(17)shoot(14)shoot(15)shoot(19)shoot(20)shoot(1)shoot(2)shoot(6)shoot(7)Loop 3{shoot(3)shoot(4)shoot(5)shoot(9)shoot(10)shoot(18)shoot(11)shoot(12)shoot(16)shoot(17)shoot(14)shoot(15)shoot(19)shoot(20)}Loop 2{shoot(3)shoot(4)shoot(5)shoot(9)shoot(10)shoot(18)shoot(11)shoot(12)shoot(16)shoot(17)}recoil := recoil_scalar * 4cycle_time := 140Loop 4{shoot(3)shoot(4)shoot(5)shoot(9)shoot(10)shoot(18)}Loop 4{shoot(3)shoot(4)shoot(5)shoot(9)shoot(10)}DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", -475, \"UInt\", 85 - 25 * recoil_scalar)}wish2(){Loop 2{shoot(3)shoot(8)shoot(13)shoot(18)shoot(20)shoot(1)shoot(6)shoot(5)shoot(10)shoot(15)shoot(11)shoot(16)}shoot(3)shoot(8)shoot(13)shoot(18)shoot(20)shoot(1)shoot(6)shoot(5)shoot(10)shoot(15)recoil := recoil_scalar * 4cycle_time := 140shoot(3)shoot(8)shoot(13)shoot(18)shoot(20)shoot(1)shoot(6)recoil := recoil_scalar * 4cycle_time := 200shoot(3)shoot(8)shoot(13)shoot(18)shoot(20)Loop 5{shoot(3)shoot(8)shoot(13)shoot(18)}shoot(3)shoot(8)DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", 0, \"UInt\", 110 - 32 * recoil_scalar)}wish3(){shoot(17)shoot(19)shoot(11)shoot(13)shoot(15)shoot(7)shoot(9)shoot(1)shoot(3)shoot(5)cycle_time := 140Loop 8{shoot(17)shoot(19)shoot(11)shoot(13)shoot(15)}recoil := recoil_scalar * 4cycle_time := 200Loop 4{shoot(17)shoot(19)shoot(7)shoot(9)}DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", -250, \"UInt\", 95 - 30 * recoil_scalar)}wish4(){Loop 5{shoot(2)shoot(3)shoot(4)shoot(1)shoot(7)shoot(14)shoot(20)shoot(5)shoot(9)shoot(12)shoot(16)}Loop 3{shoot(2)shoot(3)shoot(4)shoot(1)shoot(7)shoot(14)shoot(20)shoot(5)shoot(9)shoot(12)}shoot(2)shoot(3)shoot(4)shoot(16)shoot(8)shoot(6)shoot(10)shoot(11)shoot(15)shoot(17)shoot(18)shoot(19)shoot(2)shoot(3)shoot(4)shoot(1)shoot(7)shoot(14)shoot(20)shoot(16)shoot(8)shoot(6)shoot(10)shoot(11)shoot(15)Send, RSleep, 2000Loop 5{shoot(2)shoot(3)shoot(4)shoot(1)shoot(7)shoot(14)shoot(20)shoot(5)shoot(9)shoot(12)shoot(16)shoot(8)shoot(6)shoot(10)shoot(11)shoot(15)shoot(17)shoot(18)shoot(19)}shoot(2)shoot(3)shoot(4)shoot(1)shoot(7)shoot(14)shoot(20)shoot(16)shoot(8)DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", 0, \"UInt\", 110 - 25 * recoil_scalar)}wish5(){Loop 5{shoot(8)shoot(3)shoot(13)shoot(18)shoot(2)shoot(4)shoot(17)shoot(19)shoot(7)shoot(9)}Loop 4{shoot(8)shoot(3)shoot(13)shoot(18)shoot(2)shoot(4)shoot(17)shoot(19)shoot(12)shoot(14)}shoot(8)shoot(3)shoot(13)shoot(18)shoot(7)shoot(9)shoot(1)shoot(5)shoot(16)shoot(20)shoot(8)shoot(3)shoot(13)shoot(18)shoot(2)shoot(4)shoot(17)shoot(9)shoot(12)shoot(14)shoot(1)shoot(5)shoot(16)shoot(20)shoot(8)shoot(3)shoot(13)shoot(18)shoot(19)shoot(7)shoot(9)shoot(12)shoot(14)shoot(1)shoot(5)shoot(16)shoot(20)shoot(8)shoot(3)shoot(13)shoot(18)shoot(2)shoot(4)shoot(17)shoot(12)shoot(14)shoot(1)shoot(8)shoot(3)shoot(13)shoot(18)shoot(19)shoot(7)shoot(9)shoot(12)shoot(14)shoot(5)shoot(16)shoot(20)shoot(8)shoot(3)shoot(13)shoot(18)shoot(2)shoot(4)shoot(17)shoot(19)shoot(7)shoot(12)shoot(14)shoot(1)shoot(5)shoot(16)shoot(20)shoot(8)DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", 0, \"UInt\", 110 - 25 * recoil_scalar)}wish6(){shoot(3)shoot(2)shoot(4)shoot(16)shoot(17)shoot(18)shoot(19)shoot(20)shoot(1)shoot(5)shoot(7)shoot(9)shoot(6)shoot(10)shoot(11)shoot(15)Loop 2{shoot(3)shoot(2)shoot(4)shoot(16)shoot(17)shoot(18)shoot(19)shoot(20)shoot(5)shoot(7)shoot(9)}Loop 2{shoot(3)shoot(2)shoot(4)shoot(16)shoot(17)shoot(18)shoot(19)shoot(20)shoot(1)shoot(7)shoot(9)}Loop 2{shoot(3)shoot(2)shoot(4)shoot(16)shoot(17)shoot(18)shoot(19)shoot(20)shoot(1)shoot(5)shoot(9)}Loop 2{shoot(3)shoot(2)shoot(4)shoot(16)shoot(17)shoot(18)shoot(19)shoot(20)shoot(1)shoot(5)shoot(7)}shoot(3)shoot(2)shoot(4)shoot(18)shoot(19)shoot(20)shoot(1)shoot(5)shoot(7)shoot(9)shoot(3)shoot(2)shoot(4)shoot(16)shoot(17)shoot(18)shoot(1)shoot(5)shoot(7)shoot(9)shoot(3)shoot(2)shoot(4)shoot(16)shoot(17)shoot(19)shoot(20)shoot(1)shoot(5)shoot(7)shoot(9)recoil := recoil_scalar * 4cycle_time := 250shoot(3)shoot(2)shoot(4)cycle_time := 850Loop 3{shoot(3)}DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", 0, \"UInt\", 325 - 25 * recoil_scalar)}wish7(){Loop 2 {shoot(1)shoot(16)shoot(10)shoot(15)shoot(13)shoot(3)shoot(18)shoot(6)shoot(11)shoot(9)}Loop 2 {shoot(1)shoot(16)shoot(10)shoot(15)shoot(13)shoot(3)shoot(18)shoot(6)shoot(11)shoot(14)}Loop 2 {shoot(1)shoot(16)shoot(10)shoot(15)shoot(13)shoot(3)shoot(18)shoot(6)shoot(11)shoot(5)}Loop 2 {shoot(1)shoot(16)shoot(10)shoot(15)shoot(13)shoot(3)shoot(18)shoot(9)shoot(14)shoot(20)}Loop 2 {shoot(1)shoot(16)shoot(10)shoot(15)shoot(13)shoot(3)shoot(18)shoot(5)shoot(2)shoot(17)}Loop 2 {shoot(1)shoot(16)shoot(10)shoot(15)shoot(13)shoot(3)shoot(18)shoot(6)shoot(11)shoot(20)}shoot(1)shoot(16)shoot(10)shoot(15)shoot(13)shoot(9)shoot(14)shoot(5)shoot(2)shoot(17)shoot(1)shoot(16)shoot(10)shoot(15)shoot(9)shoot(6)shoot(11)shoot(14)shoot(20)shoot(2)shoot(17)shoot(1)shoot(16)shoot(10)shoot(15)shoot(9)shoot(14)shoot(5)shoot(13)shoot(20)shoot(1)shoot(16)DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", 490, \"UInt\", -365 - 25 * recoil_scalar)}wish8(){Loop 3{shoot(13)shoot(3)shoot(8)shoot(18)shoot(2)shoot(7)shoot(12)shoot(17)shoot(4)shoot(9)}shoot(14)shoot(19)shoot(13)shoot(3)shoot(8)shoot(18)shoot(2)shoot(7)shoot(12)shoot(17)shoot(4)shoot(9)Loop 2{shoot(13)shoot(3)shoot(8)shoot(18)shoot(12)shoot(17)shoot(4)shoot(9)shoot(14)shoot(19)}Loop 2{shoot(13)shoot(3)shoot(8)shoot(18)shoot(2)shoot(7)shoot(4)shoot(9)shoot(14)shoot(19)}Loop 3{shoot(13)shoot(3)shoot(8)shoot(18)shoot(2)shoot(7)shoot(12)shoot(17)shoot(14)shoot(19)}Loop 3{shoot(13)shoot(3)shoot(8)shoot(18)shoot(2)shoot(7)shoot(12)shoot(17)shoot(4)shoot(9)shoot(14)shoot(19)}shoot(13)Sleep, 850shoot(13)DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", 0, \"UInt\", -120 - 25 * recoil_scalar)}wish9(){cycle_time := 400Loop 2{shoot(14)shoot(7)}Loop 2{shoot(14)shoot(8)}Loop 2{shoot(14)shoot(9)}Loop 2{shoot(14)shoot(12)}Loop 2{shoot(14)shoot(13)}cycle_time := 850Loop 4{shoot(14)}DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", -250, \"UInt\", -105 - 36 * recoil_scalar)}wish10(){Loop 2{shoot(7)shoot(8)shoot(13)shoot(14)shoot(10)shoot(15)shoot(19)shoot(20)shoot(1)shoot(2)}Loop 2{shoot(7)shoot(8)shoot(13)shoot(14)shoot(10)shoot(15)shoot(19)shoot(20)shoot(5)shoot(6)shoot(11)}cycle_time := 200Loop 3{shoot(7)shoot(8)shoot(13)shoot(14)}cycle_time := 400Loop 5{shoot(7)shoot(8)}DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", 0, \"UInt\", 110 - 36 * recoil_scalar)}wish11(){shoot(4)shoot(5)shoot(10)shoot(11)shoot(16)shoot(17)shoot(15)shoot(19)shoot(20)shoot(9)Loop 5{shoot(4)shoot(5)shoot(10)shoot(1)shoot(2)shoot(6)shoot(11)shoot(16)shoot(17)shoot(15)}Loop 3{shoot(4)shoot(5)shoot(10)shoot(1)shoot(2)shoot(6)shoot(11)shoot(16)shoot(17)shoot(9)}shoot(4)shoot(5)shoot(10)shoot(1)shoot(2)shoot(6)shoot(19)shoot(20)shoot(9)shoot(8)recoil := recoil_scalar * 3.8cycle_time := 120Loop 2{shoot(4)shoot(5)shoot(10)shoot(1)shoot(2)shoot(6)shoot(19)shoot(20)shoot(13)}Loop 2{shoot(4)shoot(5)shoot(10)shoot(1)shoot(2)shoot(6)shoot(19)}Loop 2{shoot(4)shoot(5)shoot(10)shoot(1)shoot(2)shoot(6)shoot(20)}shoot(8)DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", 0, \"UInt\", 110 - 22 * recoil_scalar)}wish12(){Loop 2{shoot(14)shoot(15)shoot(20)shoot(13)shoot(5)shoot(8)shoot(9)shoot(10)shoot(11)shoot(12)}Loop 2{shoot(14)shoot(15)shoot(20)shoot(13)shoot(5)shoot(8)shoot(9)shoot(10)shoot(11)shoot(16)}shoot(14)shoot(15)shoot(20)shoot(13)shoot(5)shoot(8)shoot(9)shoot(10)shoot(12)shoot(1)shoot(14)shoot(15)shoot(20)shoot(13)shoot(5)shoot(8)shoot(9)shoot(10)shoot(16)shoot(6)shoot(14)shoot(15)shoot(20)shoot(13)shoot(5)shoot(8)shoot(9)shoot(10)shoot(12)shoot(7)cycle_time := 70shoot(14)shoot(15)shoot(20)shoot(13)shoot(5)shoot(8)shoot(9)shoot(10)shoot(16)recoil := recoil_scalar * 4 cycle_time := 150shoot(14)shoot(15)shoot(20)shoot(13)shoot(5)shoot(14)shoot(15)shoot(20)shoot(13)shoot(8)shoot(14)shoot(15)shoot(20)shoot(13)shoot(9)shoot(14)shoot(15)shoot(20)shoot(13)shoot(10)recoil := recoil_scalar * 4 cycle_time := 250Loop 3{shoot(14)shoot(15)shoot(20)}DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", -475, \"UInt\", -365 - 23 * recoil_scalar)}wish13(){Loop 5{shoot(4)shoot(9)shoot(12)shoot(17)shoot(3)shoot(1)shoot(6)shoot(15)shoot(20)shoot(5)shoot(10)}Loop 5{shoot(4)shoot(9)shoot(12)shoot(17)shoot(3)shoot(1)shoot(6)shoot(15)shoot(20)shoot(11)shoot(16)}shoot(4)shoot(9)shoot(12)shoot(17)shoot(3)shoot(1)shoot(6)shoot(15)shoot(11)shoot(16)shoot(4)shoot(9)shoot(12)shoot(17)shoot(3)shoot(1)shoot(6)shoot(15)shoot(20)shoot(5)shoot(10)Loop 2{shoot(4)shoot(9)shoot(12)shoot(17)shoot(3)shoot(20)shoot(5)shoot(10)shoot(11)shoot(16)shoot(2)shoot(7)shoot(14)shoot(19)}shoot(4)shoot(9)shoot(12)shoot(17)shoot(1)shoot(6)shoot(15)DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", -475, \"UInt\", -95 - 23 * recoil_scalar)}wish14(){shoot(8)shoot(3)shoot(17)shoot(20)shoot(2)shoot(4)shoot(14)shoot(13)shoot(1)shoot(5)shoot(16)shoot(11)Loop 2{shoot(8)shoot(3)shoot(17)shoot(20)shoot(2)shoot(4)shoot(14)shoot(13)shoot(1)shoot(5)}Loop 2{shoot(8)shoot(3)shoot(17)shoot(20)shoot(2)shoot(4)shoot(14)shoot(13)shoot(1)shoot(16)}shoot(8)shoot(3)shoot(17)shoot(20)shoot(2)shoot(4)shoot(14)shoot(13)shoot(5)shoot(16)cycle_time := 100shoot(8)shoot(3)shoot(17)shoot(20)shoot(2)shoot(4)shoot(14)shoot(16)shoot(8)shoot(3)shoot(17)shoot(20)shoot(2)shoot(4)shoot(14)shoot(5)cycle_time := 150Loop 2{shoot(8)shoot(3)shoot(17)shoot(20)shoot(2)}shoot(8)shoot(3)shoot(17)shoot(20)shoot(4)cycle_time := 250shoot(8)shoot(3)shoot(17)cycle_time := 400Loop 2{shoot(8)shoot(3)}cycle_time := 800Loop 2{shoot(8)}DllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", 0, \"UInt\", 110 - 25 * recoil_scalar)}shoot(cell){\tswitch cell { case 1:\t\tcolumn := -490 * res_scalar * 8 / sensitivity\t\trow := -270 * res_scalar * 8 / sensitivity case 2: column := -250 * res_scalar * 8 / sensitivity\t\trow := -300 * res_scalar * 8 / sensitivity case 3:\t\tcolumn := 0 * res_scalar * 8 / sensitivity\t\trow := -325 * res_scalar * 8 / sensitivity case 4: column := 250 * res_scalar * 8 / sensitivity\t\trow := -300 * res_scalar * 8 / sensitivity case 5: column := 475 * res_scalar * 8 / sensitivity\t\trow := -270 * res_scalar * 8 / sensitivity\tcase 6:\t\tcolumn := -490 * res_scalar * 8 / sensitivity\t\trow := -85 * res_scalar * 8 / sensitivity\tcase 7:\t\tcolumn := -250 * res_scalar * 8 / sensitivity\t\trow := -95 * res_scalar * 8 / sensitivity\tcase 8:\t\tcolumn := 0 * res_scalar * 8 / sensitivity\t\trow := -110 * res_scalar * 8 / sensitivity\tcase 9:\t\tcolumn := 250 * res_scalar * 8 / sensitivity\t\trow := -95 * res_scalar * 8 / sensitivity\tcase 10:\t\tcolumn := 475 * res_scalar * 8 / sensitivity\t\trow := -85 * res_scalar * 8 / sensitivity\tcase 11:\t\tcolumn := -490 * res_scalar * 8 / sensitivity\t\trow := 95 * res_scalar * 8 / sensitivity\tcase 12:\t\tcolumn := -250 * res_scalar * 8 / sensitivity\t\trow := 105 * res_scalar * 8 / sensitivity\tcase 13:\t\tcolumn := 0 * res_scalar * 8 / sensitivity\t\trow := 120 * res_scalar * 8 / sensitivity\tcase 14:\t\tcolumn := 250 * res_scalar * 8 / sensitivity\t\trow := 105 * res_scalar * 8 / sensitivity\tcase 15:\t\tcolumn := 475 * res_scalar * 8 / sensitivity\t\trow := 95 * res_scalar * 8 / sensitivity\tcase 16:\t\tcolumn := -490 * res_scalar * 8 / sensitivity\t\trow := 365 * res_scalar * 8 / sensitivity\tcase 17:\t\tcolumn := -250 * res_scalar * 8 / sensitivity\t\trow := 365 * res_scalar * 8 / sensitivity\tcase 18:\t\tcolumn := 0 * res_scalar * 8 / sensitivity\t\trow := 365 * res_scalar * 8 / sensitivity\tcase 19:\t\tcolumn := 250 * res_scalar * 8 / sensitivity\t\trow := 365 * res_scalar * 8 / sensitivity\tcase 20:\t\tcolumn := 475 * res_scalar * 8 / sensitivity\t\trow := 365 * res_scalar * 8 / sensitivity\t\t }\t\tDllCall(\"mouse_event\", \"UInt\", 0x01, \"UInt\", column - pos_x, \"UInt\", row - pos_y + recoil)\tSleep, cycle_time\tClick\t\tpos_x := column\tpos_y := row}jump(){Send, RSend, {Space down}Sleep, 100Send, {Space up}Send, {Space down}Sleep, 100Send, {Space up}Sleep, 5500pos_x := 0pos_y := 0recoil := recoil_scalar * 3.5cycle_time := 55}F4::ExitApp" }, { "title": "VoIP Softphone Firewall Script", "url": "/posts/voip-softphone-firewall-script/", "categories": "script", "tags": "script, rmm, voip, firewall", "date": "2019-03-01 09:00:00 +0000", "snippet": "VoIP Softphone Firewall ScriptScript to automatically create an inbound firewall rule for a specified applicationsoftphone-firewall.ps1$profiles = Get-ChildItem -Path 'C:\\Users' -DirectoryForeach ($profile in $profiles) { $ExePath = Join-Path -Path $profile.Fullname -ChildPath 'appdata\\local\\bt\\softphoneapp\\softphone.exe' if (!(Get-NetFirewallApplicationFilter -Program $ExePath)) { New-NetFirewallRule -Displayname \"softphone.exe\" -Direction Inbound -Program $ExePath }}" }, { "title": "Powershell Hostfile Replacement", "url": "/posts/powershell-hostfile-replacement/", "categories": "script", "tags": "rmm, script, powershell, hostfile", "date": "2019-02-25 09:00:00 +0000", "snippet": "Powershell Hostfile ReplacementScript to replace existing Hostfile entries with the below specified addresses instead.hostfile-replace.ps1Set-ExecutionPolicy -ExecutionPolicy Unrestricted$ip1 = \"1.1.1.1\"$ip2 = \"8.8.8.8\"$hst1 = \"example.co.uk\"$hst2 = \"example.com\"$hostFilePath = \"$($env:windir)\\system32\\Drivers\\etc\\hosts\"$hostfile = Get-Content -Path $hostFilePath$newHostFileEntry1 = \"{0} {1}\" -f $ip1, $hst1$newHostFileEntry2 = \"{0} {1}\" -f $ip2, $hst2# Delete all text after what is defined as $matchString$lastIndexOfNewArray = 0$matchString = '127.0.0.1\\s+localhost'for ($index = 0; $index -lt $hostfile.Count; $index++) { if ($hostfile[$index] -match $matchString) { $lastIndexOfNewArray = $index break }}$newHostFileContent = $Hostfile[0..$lastIndexOfNewArray]# Adds entry for local IP address if conditions resolve to $trueif ($newHostFileContent -notcontains \"127.0.0.2 hostname1\" -and (-not($newHostFileContent -like $newHostFileEntry1))) { $newHostFileContent = New-Object System.Collections.ArrayList(,$newHostFileContent) $newHostFileContent.Add($newHostFileEntry1) &gt; $null $newHostFileContent.Add($newHostFileEntry2) &gt; $null}Out-File -Encoding UTF8 -FilePath $hostFilePath -InputObject $newHostFileContent -Append:$false -Confirm:$false" } ]
